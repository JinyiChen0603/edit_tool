---
id: 307
title: Maximal Space Diagonal
question_type: 数学
domain: 高中数学竞赛组合
difficulty: 中学
knowledge_point: 约束组合计数：直线投影跨度
batch: 01_第一批100题
teacher: zhuyoupeng
---

## 题目
In the $6 \times 6 \times 6$ lattice point array $C = \{(x,y,z) \mid 1 \le x,y,z \le 6, x,y,z \in \mathbb{Z}\}$, a "Maximal Space Diagonal" is defined as a straight line segment that satisfies the following conditions:Its direction vector is of the form $(\pm 1, \pm 1, \pm 1)$.It contains a set of lattice points from $C$.It cannot be extended in either direction to include more lattice points within $C$ (i.e., it connects boundary to boundary).Find the total number of "Maximal Space Diagonals" in $C$ that contain exactly $4$ lattice points.

## 解答
Solution1. Analyze the Geometric ConstraintsA "Maximal Space Diagonal" with direction $(\pm 1, \pm 1, \pm 1)$ represents a line traversing the grid diagonally. For a line to contain exactly $k=4$ points, it must start at some lattice point $P_{start}$ and end at $P_{end} = P_{start} + 3\vec{v}$ (spanning 3 steps), such that $P_{start}$ and $P_{end}$ are on the "boundaries" of the grid (cannot be extended backward or forward).2. Coordinate Analysis for a Single DirectionLet's consider the specific direction vector $\vec{v} = (1, 1, 1)$.Let the starting point be $P_{start} = (x, y, z)$.The points on the line are $(x, y, z), (x+1, y+1, z+1), (x+2, y+2, z+2), (x+3, y+3, z+3)$.For this segment to be a valid "Maximal Space Diagonal" of length 4:Validity: The end point must be inside the grid.$x+3 \le 6, y+3 \le 6, z+3 \le 6 \implies x, y, z \le 3$.So, the starting coordinates $(x,y,z)$ must be in the range $[1, 3]$.Maximality (Boundary Condition):Backward Constraint: It cannot extend backwards to $(x-1, y-1, z-1)$. This means at least one coordinate of the theoretical previous point must be $< 1$.$\implies \min(x, y, z) = 1$.Forward Constraint: It cannot extend forwards to $(x+4, y+4, z+4)$. This means at least one coordinate of the theoretical next point must be $> 6$.$\implies \max(x+4, y+4, z+4) > 6 \implies \max(x, y, z) + 4 > 6 \implies \max(x, y, z) > 2$.Since we established $x,y,z \le 3$, this implies $\max(x, y, z) = 3$.3. Counting Valid Starting PointsThe problem reduces to finding the number of tuples $(x, y, z)$ with $x, y, z \in \{1, 2, 3\}$ such that:The minimum element is $1$ ($\min(x,y,z)=1$).The maximum element is $3$ ($\max(x,y,z)=3$).We use the Principle of Inclusion-Exclusion:Total tuples in $\{1, 2, 3\}^3$: $3^3 = 27$.Exclude tuples without 1 (i.e., elements in $\{2, 3\}$): $\min \ge 2$.$2^3 = 8$.Exclude tuples without 3 (i.e., elements in $\{1, 2\}$): $\max \le 2$.$2^3 = 8$.Add back intersection (tuples without 1 AND without 3, i.e., elements in $\{2\}$):$1^3 = 1$.Number of valid start points for direction $(1,1,1)$:$N = \text{Total} - (\text{No 1}) - (\text{No 3}) + (\text{No 1 and No 3})$$N = 27 - 8 - 8 + 1 = 12$.4. Total CountThere are 4 possible space diagonal directions: $(1, 1, 1), (1, 1, -1), (1, -1, 1), (-1, 1, 1)$.(Note: $(1,1,1)$ is the same line set as $(-1,-1,-1)$ just traversed differently, but "Maximal Space Diagonal" refers to the geometric line. The symmetry of the cube means the count $N=12$ applies to each of the 4 unique spatial diagonal axes).Total "Maximal Space Diagonals" = $12 \times 4 = 48$.

## 答案
48
