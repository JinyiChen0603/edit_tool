---
id: 306
title: Lines in 3D Lattice Grid
question_type: 数学
domain: 高中数学竞赛组合
difficulty: 中学
knowledge_point: 空间解析几何：离散格点计数
batch: 01_第一批100题
teacher: zhuyoupeng
---

## 题目
Consider the set of points $S = \{(x, y, z) \mid x, y, z \in \{1, 2, \dots, 7\}\}$ in three - dimensional space. These points form a cube grid with a side length of 7. Find the total number of distinct lines that pass through this set of points and contain exactly 4 points.

## 解答
This problem requires finding the number of lines that contain exactly 4 points in a 7 × 7 × 7 grid. The maximum dimension of the grid is 7.
If a line contains k grid points, then the components $(a, b, c)$ of its direction vector must satisfy $3 \cdot \max(|a|, |b|, |c|) \leq 6$ (i.e., the span between points does not exceed 6), so that it can accommodate 4 points (with a span of 3 intervals). This means $\max(|a|, |b|, |c|) \leq 2$.
Consider the types of direction vectors:
1. Directions parallel to the coordinate axes: such as $(1, 0, 0)$. The maximum capacity is 7. We need to select line segments of length 4 from them.
- On a line of length 7, there are $$7 - 4 + 1 = 4$$ starting positions for line segments of length 4.
- There are 3 axial directions, and each direction has $$7^2 = 49$$ parallel lines.
- Quantity: $$3 \times 49 \times 4 = 588$$.
2. Directions parallel to the face diagonals: such as $(1, 1, 0)$. The maximum capacity is 7. Similarly, we need line segments of length 4.
- Consider the diagonals in the $x - y$ plane. A diagonal is defined by $x - y = k$, and its length is $7 - |k|$.
- We need diagonals with length $\geq 4$, i.e., $|k| \leq 3$. The valid values of $k$ are $-3, -2, -1, 0, 1, 2, 3$.
- For a diagonal with length $L \geq 4$, the number of line segments of length 4 it contains is $L - 3$.
- Calculate the total number of starting positions: $k = 0 \Rightarrow L = 7 \Rightarrow 4$ segments; $k = \pm 1 \Rightarrow L = 6 \Rightarrow 3$ segments; $k = \pm 2 \Rightarrow L = 5 \Rightarrow 2$ segments; $k = \pm 3 \Rightarrow L = 4 \Rightarrow 1$ segment.
- The total number of segments in a single plane is: $2(1 + 2 + 3) + 4 = 16$.
- There are 3 plane directions ($xy, xz, yz$), and each plane has 7 layers of vertical coordinates.
- Quantity: $$3 \times 7 \times 16 = 336$$.
3. Directions parallel to the space diagonals: such as $(1, 1, 1)$. The maximum capacity is 7.
- We need to calculate the number of space diagonals passing through the cube. A space diagonal is determined by its intersection points with the three faces $x = 1$, $y = 1$, $z = 1$.
- Intersecting with $x = 1$: $y, z \in \{1, \dots, 7\}$, there are $7 \times 7 = 49$ lines.
- Intersecting with $y = 1$ (and $x \neq 1$): $x \in \{2, \dots, 7\}$, $z \in \{1, \dots, 7\}$, there are $6 \times 7 = 42$ lines.
- Intersecting with $z = 1$ (and $x, y \neq 1$): $x, y \in \{2, \dots, 7\}$, there are $6 \times 6 = 36$ lines.
- Total number of lines: $$49 + 42 + 36 = 127$$.
- Each line contains $7 - 3 = 4$ line segments of length 4.
- There are 4 different space diagonal directions (different sign parities).
- Quantity: $$127 \times 4 \times 4 = 2032$$.
Total: $$588 + 336 + 2032 = 2956$$

## 答案
2956
