---
id: 318
title: Weighted Binary Digits Sum
question_type: 数学
domain: 高中数学竞赛数论
difficulty: 中学
knowledge_point: 数论：逆元构造与位运算综合
batch: 01_第一批100题
teacher: zhuyoupeng
---

## 题目
For a positive integer $n$, define $b_n$ as the unique integer solution in the interval $(0, 2^n)$ to the equation $13x \equiv 1 \pmod{2^n}$. Let $g(n, k)$ be the $k$-th digit symbol (coefficient of $2^k$) from the lowest position in the binary representation of $b_n$, denoted as $b_n = \sum_{k=0}^{n-1} g(n, k) 2^k$.
Now construct a new sequence $\{c_n\}$ satisfying $c_n = \sum_{k=0}^{n-1} (k+1) \cdot g(n, k)$.
Find the specific value of $c_{10}$.

## 解答
## Solution
1. Core logic extraction: This problem examines the $p$-adic expansion construction of $13$ under the modulo $2^n$ system. $g(n, k)$ is essentially the coefficient of $13^{-1}$ in the 2-adic number field.
2. Bit-by-bit construction (Simplified Hensel's Lemma):
 We know that $13 \cdot b_n \equiv 1 \pmod{2^n}$. Since $13 \equiv 1 \pmod 4$, its inverse modulo $2^n$ has very strong regularity.
 ◦ $n=1: 13x \equiv 1 \pmod 2 \implies x=1 \implies b_1=(1)_2 \implies g(1,0)=1$.
 ◦ $n=2: 13x \equiv 1 \pmod 4 \implies 1x \equiv 1 \pmod 4 \implies x=1 \implies b_2=(01)_2 \implies g(2,0)=1, g(2,1)=0$.
 ◦ Iteration rule: Assume $b_n$ is known, then $b_{n+1} = b_n + \delta \cdot 2^n$.
 Substituting this into $13(b_n + \delta 2^n) \equiv 1 \pmod{2^{n+1}}$.
 Rearranging gives: $\frac{13b_n - 1}{2^n} + 13\delta \equiv 0 \pmod 2$.
 Since $13 \equiv 1 \pmod 2$, we have $\delta \equiv \frac{13b_n - 1}{2^n} \pmod 2$.
3. Calculate $g(n, k)$ bit by bit (i.e., the binary bits of $b_{10}$):
 ◦ $b_1 = 1$
 ◦ $13(1)-1=12$, $12/2=6$ (even) $\implies g(2,1)=0, b_2=1$
 ◦ $13(1)-1=12$, $12/4=3$ (odd) $\implies g(3,2)=1, b_3=1+4=5$
 ◦ $13(5)-1=64$, $64/8=8$ (even) $\implies g(4,3)=0, b_4=5$
 ◦ $13(5)-1=64$, $64/16=4$ (even) $\implies g(5,4)=0, b_5=5$
 ◦ $13(5)-1=64$, $64/32=2$ (even) $\implies g(6,5)=0, b_6=5$
 ◦ $13(5)-1=64$, $64/64=1$ (odd) $\implies g(7,6)=1, b_7=5+64=69$
 ◦ $13(69)-1=896$, $896/128=7$ (odd) $\implies g(8,7)=1, b_8=69+128=197$
 ◦ $13(197)-1=2560$, $2560/256=10$ (even) $\implies g(9,8)=0, b_9=197$
 ◦ $13(197)-1=2560$, $2560/512=5$ (odd) $\implies g(10,9)=1, b_{10}=197+512=709$
4. Calculate the weighted sum $c_{10}$:
 The sequence of binary bits $g(10, k)$ of $b_{10}$ (from $k=0$ to $9$) is: $1, 0, 1, 0, 0, 0, 1, 1, 0, 1$.
 $c_{10} = 1(0+1) + 0(1+1) + 1(2+1) + 0(3+1) + 0(4+1) + 0(5+1) + 1(6+1) + 1(7+1) + 0(8+1) + 1(9+1)$
 $$ c_{10} = 1 + 3 + 7 + 8 + 10 = 29 $$
5. Result: $29$.

## 答案
29
