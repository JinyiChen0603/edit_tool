---
id: 315
title: Binary Sum of Modular Inverses
question_type: 数学
domain: 高中数学竞赛数论
difficulty: 中学
knowledge_point: 数论：线性同余方程的解
batch: 01_第一批100题
teacher: zhuyoupeng
---

## 题目
Let the set $S = \{1, 2, \dots, 2024\}$. For each $n \in S$, define $x_n$ as the smallest positive integer satisfying the equation $17x \equiv 1 \pmod{2^n}$. Denote the binary digit sum function as $w(m)$ (e.g., $w(5) = w(101_2) = 2$). Find the value of the sum $\sum_{n=1}^{2023} [w(x_{n+1}) - w(x_n)]$, where $[condition]=1$ when the condition holds, otherwise it is $0$.

## 解答
Analysis:
1 Logic transformation: $x_n$ is actually the inverse of $17$ modulo $2^n$.
2 Iterative relationship: According to the definition of $x_n$, we have $17x_n = k \cdot 2^n + 1$. Since $x_{n+1} \equiv x_n \pmod{2^n}$, there are only two possibilities for $x_{n+1}$: $x_n$ or $x_n + 2^n$.
3 Digit sum discrimination: If $x_{n+1} = x_n$, then $w(x_{n+1}) - w(x_n) = 0$; if $x_{n+1} = x_n + 2^n$, since $x_n < 2^n$, adding $2^n$ is equivalent to changing the $n$-th bit in binary from $0$ to $1$, thus $w(x_{n+1}) - w(x_n) = 1$.
4 Summation simplification: This sum is essentially a telescoping sum: $\sum_{n=1}^{2023} (w(x_{n+1}) - w(x_n)) = w(x_{2024}) - w(x_1)$.
5 Calculating components:
 ◦ For $n=1$, $17x \equiv 1 \pmod 2 \implies x_1 = 1$, so $w(x_1) = 1$.
 ◦ For $n=2024$, utilize $17 = 2^4 + 1$. Noting that $17(2^{2024} - \sum_{i=0}^{\lfloor 2024/4 \rfloor - 1} 2^{4i} \cdot (-1)^{i} \dots)$ is complex, we switch to using the formula: $17 \cdot \frac{2^{2024}-1}{2^4+1}$ is not an integer.
 ◦ In fact, $17 \cdot \frac{1 - (-2^4)^{506}}{1 - (-2^4)} = 1 - 2^{2024}$.
 ◦ Thus $17 \cdot \frac{2^{2024}-1}{17} = 2^{2024}-1 \equiv -1 \pmod{2^{2024}}$.
 ◦ Let $b = \frac{2^{2024}-1}{17}$, then $17(2^{2024}-b) \equiv 1 \pmod{2^{2024}}$.
 ◦ $x_{2024} = 2^{2024} - \frac{2^{2024}-1}{17} = \frac{16 \cdot 2^{2024} + 1}{17}$.
 ◦ Calculate $C = \frac{2^{2024}-1}{17} = \sum_{j=0}^{252} (2^{8j+4} + 2^{8j})$, whose binary representation contains $253 \times 2 = 506$ ones.
 ◦ From $w(2^{2024}-C) = 2024 - w(C) + 1$ (for $C < 2^{2024}$), we obtain $w(x_{2024}) = 2025 - 506 = 1519$.
6 Final result: $1519 - 1 = 1518$.

## 答案
1518
