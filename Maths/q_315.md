---
id: 315
title: Binary Sum of Modular Inverses
question_type: 数学
domain: 高中数学竞赛数论
difficulty: 中学
knowledge_point: 数论：线性同余方程的解
batch: 01_第一批100题
teacher: zhuyoupeng
---

## 题目
Let the set $S = \{1, 2, \dots, 2024\}$. For each $n \in S$, define $x_n$ as the smallest positive integer satisfying the equation $17x \equiv 1 \pmod{2^n}$. 
Denote $w(m)$ as the sum of the digits in the binary representation of $m$ (also known as the Hamming weight, e.g., $w(5) = w(101_2) = 2$). 
Find the value of the sum:
$$\sum_{n=1}^{2023} (w(x_{n+1}) - w(x_n))$$

## 解答
1. Analyze the Recursive Relationship
The number $x_n$ is the modular inverse of $17$ modulo $2^n$.
From the definition:
$17 x_n \equiv 1 \pmod{2^n}$
$17 x_{n+1} \equiv 1 \pmod{2^{n+1}}$

Since $17 x_{n+1} \equiv 1 \pmod{2^{n+1}}$ implies $17 x_{n+1} \equiv 1 \pmod{2^n}$, $x_{n+1}$ must be congruent to $x_n$ modulo $2^n$.
Given that $0 < x_n < 2^n$ and $0 < x_{n+1} < 2^{n+1}$, there are only two possibilities for $x_{n+1}$:
$$x_{n+1} = x_n \quad \text{or} \quad x_{n+1} = x_n + 2^n$$

 If $x_{n+1} = x_n$, then $w(x_{n+1}) = w(x_n)$.
 If $x_{n+1} = x_n + 2^n$, since $x_n < 2^n$, the addition of $2^n$ simply sets the $n$-th bit (which was previously 0) to 1. No carry occurs. Thus, $w(x_{n+1}) = w(x_n) + 1$.

2. Telescoping Sum
The sum in question is a telescoping sum:
$$\sum_{n=1}^{2023} (w(x_{n+1}) - w(x_n)) = (w(x_2) - w(x_1)) + (w(x_3) - w(x_2)) + \dots + (w(x_{2024}) - w(x_{2023}))$$
$$= w(x_{2024}) - w(x_1)$$

3. Calculate $w(x_1)$
For $n=1$: $17x \equiv 1 \pmod{2} \implies 1 \cdot x \equiv 1 \pmod 2$.
The smallest positive solution is $x_1 = 1$.
So, $w(x_1) = 1$.

4. Calculate $w(x_{2024})$
We need to find the binary weight of $x_{2024}$, where $17 x_{2024} \equiv 1 \pmod{2^{2024}}$ and $0 < x_{2024} < 2^{2024}$.
This is equivalent to calculating the first 2024 bits of the 2-adic integer $1/17$.

Let's find the explicit form:
We assume $x_{2024} = \frac{k \cdot 2^{2024} + 1}{17}$ for some integer $k$ such that the result is an integer and lies in the valid range.
For divisibility by 17:
$k \cdot 2^{2024} + 1 \equiv 0 \pmod{17}$
Using Fermat's Little Theorem (or simple cycle calculation), $2^4 = 16 \equiv -1 \pmod{17}$.
$2^{2024} = (2^4)^{506} \equiv (-1)^{506} \equiv 1 \pmod{17}$.
So, $k(1) + 1 \equiv 0 \pmod{17} \implies k \equiv -1 \equiv 16 \pmod{17}$.
We choose $k=16$ to keep $x_{2024}$ positive.
Check the range:
$x_{2024} = \frac{16 \cdot 2^{2024} + 1}{17} = \frac{16}{17} 2^{2024} + \frac{1}{17}$.
Clearly $0 < x_{2024} < 2^{2024}$.

Now we calculate the weight. We can rewrite $x_{2024}$ as:
$$x_{2024} = \frac{16(2^{2024} - 1) + 16 + 1}{17} = 16 \left( \frac{2^{2024} - 1}{17} \right) + 1$$
Let $Q = \frac{2^{2024} - 1}{17}$.
Notice that $2^8 - 1 = 255 = 15 \times 17$. Thus $17 \mid (2^8 - 1)$.
Since $2024 = 8 \times 253$, $2^8 - 1$ divides $2^{2024} - 1$.
$$Q = \frac{2^{2024} - 1}{2^8 - 1} \times \frac{2^8 - 1}{17} = \left( \sum_{j=0}^{252} 2^{8j} \right) \times 15$$
In binary, $15$ is $1111_2$ (weight 4).
The sum $\sum_{j=0}^{252} 2^{8j}$ represents a number with a 1 at bit positions $0, 8, 16, \dots$.
Multiplying this sum by $15$ places the pattern $1111$ at each of these positions.
Since $1111_2$ occupies 4 bits and the shifts are steps of 8 bits, there is no overlap.
The binary representation of $Q$ consists of 253 blocks of $00001111$.
$$w(Q) = 253 \times w(15) = 253 \times 4 = 1012$$

Now consider $x_{2024} = 16Q + 1$.
 $16Q$ is $Q$ shifted left by 4 bits. Its binary pattern is blocks of $11110000$.
 $1$ is the bit at position 0.
The lowest block of $Q$ is $00001111$ (bits 0-7).
The lowest block of $16Q$ is $11110000$ (bits 0-7).
Adding 1 to $16Q$ affects the 0-th bit. Since the 0-th bit of $16Q$ is 0, adding 1 simply sets this bit to 1 without carry.
$$w(16Q + 1) = w(16Q) + 1 = w(Q) + 1$$
$$w(x_{2024}) = 1012 + 1 = 1013$$

5. Final Calculation
$$\text{Sum} = w(x_{2024}) - w(x_1) = 1013 - 1 = 1012$$

## 答案
1012
