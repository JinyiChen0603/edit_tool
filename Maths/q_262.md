---
id: 262
title: The Non-Hierarchical Coherent Systems
question_type: 数学
domain: 高中数学竞赛组合
difficulty: 中学
knowledge_point: Number Theory (数论): Divisibility (整除性), Coprimality (互素), Primitive Sets (本原集/无整除子集).
Order Theory (序理论): Antichains in Posets (偏序集中的反链).
Combinatorics (组合数学): Extremal Set Theory (极值集合论).
batch: 01_第一批100题
teacher: xieshuhong
---

## 题目
Let $n$ be an integer with $n \ge 2$, and let $\Omega_n = \{1, 2, \dots, n\}$. We define a subset $\mathcal{K} \subseteq \Omega_n$ as a Strongly Coupled Primitive System if it satisfies the following two conditions for any distinct elements $\alpha, \beta \in \mathcal{K}$:

- Non-Orthogonality: The elements are not coprime. $ \gcd(\alpha, \beta) > 1 $

- Independence: Neither element divides the other. $ \alpha \nmid \beta \quad \text{and} \quad \beta \nmid \alpha $

Question: What is the maximum possible cardinality of the set $\mathcal{K}$ in terms of $n$?

## 解答
Step 1: Normalization via Mapping
Let $\mathcal{K}$ be a subset satisfying the problem conditions. We construct a mapping to transform $\mathcal{K}$ into the upper half of the interval $\Omega_n$.
Consider the transformation $f: \mathcal{K} \to \Omega_n$ defined as follows: for any $x \in \mathcal{K}$, let $f(x) = x \cdot 2^k$, where $k$ is the unique non-negative integer such that:
$$ \frac{n}{2} < x \cdot 2^k \le n $$
Let $\mathcal{K}' = \{f(x) \mid x \in \mathcal{K}\}$.
Since doubling an element preserves its prime factors (introducing only factors of 2), and $f$ is injective on the set of integers (by the Fundamental Theorem of Arithmetic regarding the odd part of an integer), we have $|\mathcal{K}'| = |\mathcal{K}|$.

Step 2: Simplifying Constraints in the Upper Interval
Consider the properties of the transformed set $\mathcal{K}' \subset (\frac{n}{2}, n]$:
Independence Condition: For any distinct $a, b \in \mathcal{K}'$, since both $a > \frac{n}{2}$ and $b > \frac{n}{2}$, it is impossible for $a$ to divide $b$ (as $2a > n \ge b$). Thus, the Topological Independence condition is automatically satisfied for any subset of this interval.
Non-Orthogonality Condition: The problem effectively reduces to finding the maximum subset of $(\frac{n}{2}, n]$ such that no two elements are coprime.

Step 3: The Parity Argument
In the interval $(\frac{n}{2}, n]$, any two consecutive integers $m$ and $m+1$ are coprime (i.e., $\gcd(m, m+1) = 1$). Consequently, $\mathcal{K}'$ can contain at most one element from any adjacent pair $\{m, m+1\}$.
To maximize the cardinality while ensuring $\gcd(\alpha, \beta) > 1$ for all pairs, the optimal strategy is to select all even integers in this interval.
- If we select all even numbers in $(\frac{n}{2}, n]$, then for any pair, 2 is a common divisor.
- This selection avoids any consecutive integers (since odd numbers are excluded).

Step 4: Cardinality Calculation
The number of even integers in the interval $(\frac{n}{2}, n]$ is the count of $2k$ such that $\frac{n}{2} < 2k \le n$, which simplifies to $\frac{n}{4} < k \le \frac{n}{2}$.
The number of such integers $k$ is:
$$ \left\lfloor \frac{n}{2} \right\rfloor - \left\lfloor \frac{n}{4} \right\rfloor $$
Standard arithmetic manipulation shows this count is equivalent to:
$$ \left\lfloor \frac{n+2}{4} \right\rfloor $$

Conclusion:
The maximum number of elements in such a system is $\left\lfloor \frac{n+2}{4} \right\rfloor$.

## 答案
$$\left\lfloor \frac{n+2}{4} \right\rfloor$$
