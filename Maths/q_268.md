---
id: 268
title: A Greedy Permutation That Avoids Consecutive Numbers
question_type: 数学
domain: 高中数学竞赛组合
difficulty: 中学
knowledge_point: Greedy processes + counting
Casework on early steps
Adjacency on a path graph
Permutation counting under dynamic constraints
State compression / controlled positions intuition
batch: 01_第一批100题
teacher: xieshuhong
---

## 题目
Let ($S=\{1,2,3,4,5,6,7\}$). We generate an ordered list (($a_1,a_2,\dots,a_7$)) by the following sequential rule.
At step ($k$) (for ($1\le k\le 7$)), you must choose ($a_k$) from the remaining unused numbers in ($S\setminus\{a_1,\dots,a_{k-1}\}$). The choice is governed by the maximal non-consecutiveness rule:

If there exists at least one unused number ($x$) such that neither ($x-1$) nor ($x+1$) is among the already chosen numbers ($\{a_1,\dots,a_{k-1}\}$) (ignoring values outside ($1$) to ($7$)), then ($a_k$) may be any such ($x$).
If no such unused number exists, then ($a_k$) may be any remaining unused number.

A sequence (($a_1,\dots,a_7$)) produced by this rule is called admissible.
Question. How many admissible sequences are there?

## 解答
Key idea (the “control” viewpoint)
Place the numbers $1,2,\dots,7$ on a line. When a number $i$ has been chosen, it controls the positions $i-1$ and $i+1$ (if they exist), because choosing either later would create a consecutive pair.
At step $k$, a choice is comfortable if the chosen number is not consecutive to any previously chosen number. The rule says:

If a comfortable choice exists, you must pick a comfortable number.
Only when no comfortable numbers exist do you make an unrestricted pick among what remains.

A crucial observation (same as the original):

The first three picks can always be made comfortably.
At most the first four picks can be made comfortably.
So the last three picks are necessarily “uncomfortable/unrestricted,” hence contribute a factor of $3! = 6$ at the end.

So we count valid possibilities for the first part, then multiply by $6$.

Step 1: Count sequences where the 4th pick is still comfortable
If the 4th pick is comfortable, then the first four chosen numbers must be pairwise nonconsecutive. On $\{1,\dots,7\}$, the only 4-element set with no consecutive integers is $\{1,3,5,7\}$. Thus the first four picks must be a permutation of these four numbers:

Number of ways for $(a_1,a_2,a_3,a_4)$: $4! = 24$.
Then the remaining three picks are forced to be unrestricted (as noted): $3! = 6$.

Contribution:
$$24 \times 6$$

Step 2: Count sequences where the 4th pick is NOT comfortable
Now assume at step 4 there is no comfortable number left. Then after the first three picks, every remaining unused number is consecutive to at least one of the first three picks. In the original solution’s language: the first three picks “control” all 7 positions.
2A. How many choices can $(a_4)$ have?
In this situation, step 4 is unrestricted (no comfortable option exists). One can show (and this matches the original argument) that there are exactly 4 choices available for $(a_4)$ once the first three picks have reached this “full control” state.
So we will count the number of possible first-three-pick patterns that yield full control, and then multiply by $4$.
2B. Classify the “full control” configurations after 3 picks
After three comfortable picks, the chosen numbers themselves are nonconsecutive. Let’s count how many ordered triples $(a_1,a_2,a_3)$ result in full control. As in the original, classify by how many positions are controlled already by the first two picks.
Case (i): First two picks control exactly 4 positions
There are 3 structural patterns for the first two picks that lead to this, and then:

given the pattern, $(a_2)$ has $(2)$ compatible choices,
and then $(a_3)$ is forced to cover the remaining uncontrolled block in exactly $(1)$ way.

So the number of ordered triples here is:
$$3 \times 2 \times 1 = 6.$$
Case (ii): First two picks control exactly 5 positions
There are 6 structural patterns for the first two picks that lead to this, and then:

$(a_2)$ has $(2)$ compatible choices,
$(a_3)$ has $(2)$ choices to finish full control.

So the number of ordered triples here is:
$$6 \times 2 \times 2 = 24.$$
Case (iii): After three picks, exactly 6 positions are controlled (leaving 1 “gap”)
There are 3 structural patterns, and then:

$(a_2)$ has $(2)$ choices,
$(a_3)$ is forced $ (1)$ way.

So the number of ordered triples here is:
$$3 \times 2 \times 1 = 6.$$
Adding these (this is exactly the same numeric split as the original solution):
$$6 + 24 + 6 = 36$$

ordered triples $(a_1,a_2,a_3)$ lead to the “no comfortable choice at step 4” situation.
2C. Finish counting for this branch

For each such triple, $(a_4)$ has $(4)$ choices (unrestricted step with 4 remaining numbers).
The last three picks are then unrestricted: $3! = 6$.

Contribution:
$$36 \times 4 \times 6$$

Combine both branches
Total admissible sequences:
$$6 \times \bigl(24 + 4 \times 36\bigr)
= 6 \times (24 + 144)
= 6 \times 168
= 1008$$

Final answer
$$1008$$

## 答案
$$1008$$
