---
id: 322
title: Modular Inverse Bit Magnitude
question_type: 数学
domain: 高中数学竞赛数论
difficulty: 中学
knowledge_point: 数论：逆元的二进制分布规律
batch: 01_第一批100题
teacher: zhuyoupeng
---

## 题目
For a positive integer $n$, let $f(n)$ be the unique integer satisfying $f(n) \cdot 11 \equiv 1 \pmod{2^n}$ and $0 < f(n) < 2^n$. Find the number of all $n \in \{1, 2, \dots, 100\}$ satisfying $f(n) > 2^{n-1}$.

## 解答
Analysis:
1. Core transformation: $f(n)$ is the inverse of $11$ modulo $2^n$.
2. Recursive property: $f(n+1)$ is either equal to $f(n)$ or $f(n) + 2^n$. However, since $f(n+1) < 2^{n+1}$, this actually corresponds to whether $11f(n) \equiv 1 \pmod{2^{n+1}}$ holds.
3. Size determination: $f(n) > 2^{n-1}$ means that in the binary representation of $f(n)$, the $(n-1)$-th bit (with value $2^{n-1}$) is $1$.
According to the inverse construction: $f(n) = f(n-1) + \delta \cdot 2^{n-1}$, where $\delta \in \{0, 1\}$.
$f(n) > 2^{n-1}$ is equivalent to $\delta = 1$, which means $11f(n-1) \not\equiv 1 \pmod{2^n}$.
4. Periodicity: The modulus is $11$. Since $2^{10} \equiv 1 \pmod{11}$ but $2^5 \equiv 32 \equiv -1 \pmod{11}$, the order of $2$ modulo $11$ is $10$.
$f(n) = f(n-1) \iff 11 \mid \frac{11f(n-1)-1}{2^{n-1}}$.
Let $11f(n) = k_n 2^n + 1$. Then $f(n) = f(n+1) \iff k_n$ is even. (Note: This logic is consistent with Variant Problem 2).
Within a cycle of length $10$, calculate the parity of $k_n$.
$k_n \equiv (2^n)^{-1} \pmod{11}$.
The sequence of $k_n \pmod{11}$ for ($n=1 \dots 10$) is: $6, 3, 7, 9, 10, 5, 8, 4, 2, 1$.
Among them, the even numbers are: $6, 10, 8, 4, 2$ (5 in total).
$f(n) > 2^{n-1}$ corresponds to $k_{n-1}$ being odd (so that adding $2^{n-1}$ is required for correction).
There are 5 odd numbers in a cycle.
5. Calculation: $100$ contains $10$ cycles, with $5$ in each cycle, totaling $50$.

## 答案
50
