---
id: 263
title: The Isomeric Lattice Embedding Problem
question_type: 数学
domain: 高中数学竞赛组合
difficulty: 中学
knowledge_point: Hamiltonian Paths on Grid Graphs: The problem essentially asks for a Hamiltonian path on a $100 \times 100$ grid graph that maximizes a specific geometric property.
Combinatorial Geometry: Analyzing the spatial distribution of a sequence mapped onto a 2D structure.
Translation Tiling: The optimal solution relies on the concept of tiling a shape with two congruent sets (the set of the first 5000 points and the set of the last 5000 points) related by a translation vector.
Euclidean Optimization: Understanding distance metrics in discrete grid environments.
batch: 01_第一批100题
teacher: xieshuhong
---

## 题目
Let $\mathcal{L}$ be a finite lattice grid in the Euclidean plane defined as:
$$ \mathcal{L} = \{(x, y) \in \mathbb{Z}^2 \mid 1 \le x, y \le 100\} $$

Consider a bijective mapping $\phi: \{1, 2, \dots, 10000\} \to \mathcal{L}$. This mapping is subject to a strict adjacency constraint, such that consecutive indices are mapped to spatially adjacent lattice points:
$$ \|\phi(i) - \phi(i+1)\| = 1 \quad \text{for all } 1 \le i < 10000 $$
where $\|\cdot\|$ denotes the standard Euclidean distance.

We define the minimum phase separation, denoted by $\mathcal{S}$, as the minimum Euclidean distance between the images of any two indices that differ by exactly 5000:
$$ \mathcal{S}(\phi) = \min_{1 \le k \le 5000} \|\phi(k) - \phi(k+5000)\| $$

Determine the maximum possible value of $\mathcal{S}(\phi)$ over all valid mappings $\phi$.

## 解答
1. Proof of Upper Bound
We first demonstrate that the minimum phase separation cannot exceed $50\sqrt{2}$.
Consider the central lattice point $C = (50, 50)$. Let $k$ be the index mapped to this point, such that $\phi(k) = (50, 50)$. We must examine the distance to its corresponding pair index, $\phi(k \pm 5000)$.
In a $100 \times 100$ grid defined by $1 \le x, y \le 100$, the point farthest from $(50, 50)$ is the corner $(100, 100)$ (or equivalently $(100, 1)$ etc.). The maximum Euclidean distance from the center to any point in the grid is:
$$ d_{\text{max}} = \sqrt{(100-50)^2 + (100-50)^2} = \sqrt{50^2 + 50^2} = 50\sqrt{2} $$
Since $\mathcal{S}(\phi)$ is defined as the minimum of all such pair distances, it must satisfy the condition of the "bottleneck" case:
$$ \mathcal{S}(\phi) \le |\phi(k) - \phi(k \pm 5000)| \le 50\sqrt{2} $$
Thus, $\mathcal{S} \le 50\sqrt{2}$.

2. Constructive Proof (Lower Bound)
We now construct a specific mapping $\phi$ that achieves this bound, proving that $\mathcal{S} = 50\sqrt{2}$ is attainable.
Grid Partitioning:
Divide the $100 \times 100$ grid into four $50 \times 50$ quadrants. We define a local coordinate system $(u, v)$ where $1 \le u, v \le 50$.
The Mapping $\phi$:
Let the first quarter of indices $k \in {1, \dots, 2500}$ fill the bottom-left quadrant ($1 \le x, y \le 50$) continuously such that $\phi(1)=(1,1)$ and $\phi(2500)=(50,1)$.
For any $k \in {1, \dots, 2500}$ mapped to position $\phi(k) = (u, v)$, we map the subsequent quarters as follows:

First Quarter ($k$):
$$ \phi(k) = (u, v) $$
Second Quarter ($k+2500$): Map to Bottom-Right, transposed.
$$ \phi(k+2500) = (v+50, u) $$
Third Quarter ($k+5000$): Map to Top-Right, transposed relative to Q1.
$$ \phi(k+5000) = (v+50, u+50) $$
Fourth Quarter ($k+7500$): Map to Top-Left, reflected.
$$ \phi(k+7500) = (51-u, 101-v) $$

Distance Verification:
We must verify that for any pair with index difference 5000, the distance is at least $50\sqrt{2}$.
Case A: Pair $(k, k+5000)$
The points are $P_1=(u, v)$ and $P_2=(v+50, u+50)$.
The squared Euclidean distance is:
$$ D^2 = (v+50-u)^2 + (u+50-v)^2 $$
Let $\delta = v-u$. Then:
$$ D^2 = (50+\delta)^2 + (50-\delta)^2 $$
$$ D^2 = 2500 + 100\delta + \delta^2 + 2500 - 100\delta + \delta^2 = 5000 + 2\delta^2 $$
Since $\delta^2 \ge 0$, the minimum value is 5000.
$$ D \ge \sqrt{5000} = 50\sqrt{2} $$
Case B: Pair $(k+2500, k+7500)$
The points are $P_3=(v+50, u)$ and $P_4=(51-u, 101-v)$.
Let $\Delta x$ and $\Delta y$ be the horizontal and vertical distances:
$$ \Delta x = |(v+50) - (51-u)| = |v+u-1| $$
$$ \Delta y = |u - (101-v)| = |u+v-101| $$
Let $S = u+v$. Since $1 \le u,v \le 50$, we have $2 \le S \le 100$.
$$ \Delta x = S-1 $$
$$ \Delta y = 101-S $$
Notice that $\Delta x + \Delta y = (S-1) + (101-S) = 100$.
To minimize $D^2 = \Delta x^2 + \Delta y^2$ subject to a constant sum, the terms must be equal.
$$ \Delta x = \Delta y = 50 $$
$$ D^2_{\text{min}} = 50^2 + 50^2 = 5000 \implies D \ge 50\sqrt{2} $$
Conclusion:
Since we have proved $\mathcal{S} \le 50\sqrt{2}$ and constructed a valid case where $\mathcal{S} \ge 50\sqrt{2}$, the maximum possible value is exactly $50\sqrt{2}$.

## 答案
$$50\sqrt{2}$$
