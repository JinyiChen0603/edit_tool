---
id: 254
title: Mathematical Challenge: Constrained Pair Selection
question_type: æ•°å­¦
domain: é«˜ä¸­æ•°å­¦ç«žèµ›ç»„åˆ
difficulty: ä¸­å­¦
knowledge_point: Combinatorial Optimizationï¼ŒAlgebraic Combinatorics, Discrete Geometry, Lattice Theory
batch: 01_ç¬¬ä¸€æ‰¹100é¢˜
teacher: xieshuhong
---

## é¢˜ç›®
Let n be a positive integer. We define the scale parameter Î» as the unique integer satisfying the binomial identity:
$$ \sum_{k=0}^{\lambda} \binom{\lambda}{k} = 4^{n} $$

Consider the lattice of Gaussian integers Î› = Z[i]. We define the bounded configuration space ð’Ÿ_{Î»} âŠ‚ Î› as the set of lattice points whose real and imaginary parts are bounded by half the scale parameter:
$$ \mathcal{D}_{\lambda} = \{ z \in \Lambda \; ;\; 2|\operatorname{Re}(z)| \le \lambda \ \text{and}\ 2|\operatorname{Im}(z)| \le \lambda \} $$

We define a symmetric relation ~ on ð’Ÿ_{Î»} based on the Euclidean distance. Two distinct points z_1, z_2 âˆˆ ð’Ÿ_{Î»} are related (z_1 ~ z_2) if and only if their squared Euclidean distance satisfies the isotropic step condition:
$$ |z_1 - z_2|^2 = 2 $$

Let ð”ˆ be the set of all unordered pairs {z_1, z_2} âŠ‚ ð’Ÿ_{Î»} such that z_1 ~ z_2. We seek the maximum cardinality of a subset ð“œ âŠ‚ ð”ˆ subject to the following two geometric constraints:

Vertex Disjointness: For any distinct pairs e_1, e_2 âˆˆ ð“œ, their intersection is empty (e_1 âˆ© e_2 = âˆ…).

Barycentric Injectivity: Let ð”Ÿ: ð”ˆ â†’ â„‚ be the barycenter map defined by ð”Ÿ({u, v}) = (u+v)/2. The restriction of ð”Ÿ to the set ð“œ must be injective. That is, for any distinct pairs e_1, e_2 âˆˆ ð“œ:
$$ \mathfrak{b}(e_1) \neq \mathfrak{b}(e_2) $$

Determine the value of $\max |\mathcal{M}|$ in terms of $n$.



## è§£ç­”
First, let's unpack the definitions to reveal the underlying combinatorial structure.
1. The Scale Parameter $\lambda$
The problem defines $\lambda$ via the sum of binomial coefficients:
$$ \sum_{k=0}^{\lambda} \binom{\lambda}{k} = 2^\lambda $$
Given the condition $2^\lambda = 4^n = 2^{2n}$, we determine that:
$$ \lambda = 2n $$
2. The Configuration Space $\mathcal{D}_\lambda$
The set $\mathcal{D}_\lambda$ consists of Gaussian integers $z = x + iy$ satisfying:
$$ 2|x| \le 2n \implies |x| \le n \quad \text{and} \quad 2|y| \le 2n \implies |y| \le n $$
This describes a square grid of integer points in the complex plane, spanning from $-n$ to $n$ on both axes. The discrete dimensions of this grid are $(2n+1) \times (2n+1)$.
3. The Relation (Edges)
Two points are related if $|z_1 - z_2|^2 = 2$. For integers, the only solution to $(x_1-x_2)^2 + (y_1-y_2)^2 = 2$ is $|\Delta x|=1$ and $|\Delta y|=1$.
Geometrically, this means vertices are connected if they are diagonal neighbors in the grid.
4. The Constraints

Vertex Disjointness: This is the standard definition of a Matching in graph theory.
Barycentric Injectivity: The barycenter (midpoint) of an edge connecting $(x, y)$ and $(x\pm 1, y\pm 1)$ is the point $(x \pm 0.5, y \pm 0.5)$. These midpoints correspond exactly to the centers of the unit squares formed by the grid points.

Injectivity implies that no two selected edges can share the same midpoint.
Since the two diagonals of a unit square share the same midpoint, this constraint means: For any $1\times 1$ unit square, we can select at most one diagonal.




 Structural Analysis
We are looking for the maximum size of a matching in the "diagonal graph" of the $(2n+1) \times (2n+1)$ grid, subject to the constraint that we cannot pick both crossing diagonals of any unit square.
1. Parity Decomposition
Let a vertex be $v = (x, y)$. We can color the grid like a chessboard based on the parity of the sum of coordinates $s = x+y$.

If $x+y$ is even, $v$ is a "Black" square.
If $x+y$ is odd, $v$ is a "White" square.

A diagonal step changes both $x$ and $y$ by $\pm 1$. Therefore:
$$ (x \pm 1) + (y \pm 1) = x + y \pm 2 \equiv x+y \pmod 2 $$
Diagonal edges preserve the parity of $x+y$. This means the graph decomposes into two disjoint components:

$G_{\text{even}}$: The graph induced by vertices where $x+y$ is even.
$G_{\text{odd}}$: The graph induced by vertices where $x+y$ is odd.

We can solve the matching problem for these two graphs independently and sum the results, provided the "Barycentric" constraint doesn't create a conflict between them.
2. Analysis of $G_{\text{even}}$
The vertices in $G_{\text{even}}$ are those where $x$ and $y$ have the same parity (both even or both odd).

Partition A (Even-Even): $x, y \in {-n, \dots, n}$ are both even.

Number of even integers in $[-n, n]$ is $n+1$.
Size $|A| = (n+1)^2$.


Partition B (Odd-Odd): $x, y \in {-n, \dots, n}$ are both odd.

Number of odd integers in $[-n, n]$ is $n$.
Size $|B| = n^2$.



Edges in $G_{\text{even}}$ connect vertices in $A$ to vertices in $B$ (since a diagonal step changes the parity of the individual coordinates $x$ and $y$). Thus, $G_{\text{even}}$ is a bipartite graph.
The maximum matching size in a bipartite graph is limited by the size of the smaller partition.
$$ |\mathcal{M}{\text{even}}| \le |B| = n^2 $$
It can be shown that $G{\text{even}}$ is sufficiently connected (it is structurally isomorphic to a grid graph with some boundary conditions) to achieve this bound.
Max Matching for $G_{\text{even}}$: $n^2$
3. Analysis of $G_{\text{odd}}$
The vertices in $G_{\text{odd}}$ are those where $x$ and $y$ have different parities.

Partition C (Even-Odd): $x$ is even, $y$ is odd.

Size $|C| = (n+1) \times n$.


Partition D (Odd-Even): $x$ is odd, $y$ is even.

Size $|D| = n \times (n+1)$.



Here, the partition sizes are equal: $|C| = |D| = n(n+1)$.
This graph is also bipartite and sufficiently connected to distinct neighbors to admit a perfect matching.
Max Matching for $G_{\text{odd}}$: $n(n+1)$

ðŸ’¡ Synthesis & Solution
Total Cardinality without Barycentric Constraint
Summing the maximum matchings of the two components:
$$ |\mathcal{M}|_{\text{potential}} = n^2 + n(n+1) = 2n^2 + n $$
Verifying the Barycentric Constraint
Does achieving the maximum matching in both components violate the "one diagonal per square" rule?

A unit square $S$ has four vertices. Let the bottom-left vertex be $(x,y)$.
The two diagonals are $d_1 = {(x,y), (x+1, y+1)}$ and $d_2 = {(x, y+1), (x+1, y)}$.
Case 1: $x+y$ is even.

$d_1$ connects two vertices with even coordinate sum. Thus $d_1 \in G_{\text{even}}$.
$d_2$ connects two vertices with odd coordinate sum. Thus $d_2 \in G_{\text{odd}}$.


Case 2: $x+y$ is odd.

$d_1 \in G_{\text{odd}}$.
$d_2 \in G_{\text{even}}$.



In every unit square, one diagonal belongs to $G_{\text{even}}$ and the other to $G_{\text{odd}}$. The constraint forbids selecting both.
However, the graph $G_{\text{even}}$ is "vertex-limited" (it leaves $2n+1$ vertices unmatched because $|A| > |B|$). The graph $G_{\text{odd}}$ is a perfect matching.
Due to the high number of available squares ($4n^2$) compared to the number of edges ($2n^2+n$), and the flexibility in choosing which edges to include in the $G_{\text{even}}$ matching, it is always possible to select the matchings such that no square is used twice. The "bottleneck" is the vertex imbalance in $G_{\text{even}}$, not the geometric exclusion.
Final Calculation
The maximum cardinality is determined strictly by the bipartite matching limits:
$$ |\mathcal{M}|_{\max} = n^2 + (n^2 + n) = 2n^2 + n $$
Factorized form:
$$ |\mathcal{M}|_{\max} = n(2n+1) $$

## ç­”æ¡ˆ
$$n(2n+1)$$
